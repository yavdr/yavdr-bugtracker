<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de">
<head>
<!-- 2019-08-03 Sa 19:33 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ansible Playbooks f√ºr yaVDR</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Alexander Grothe (seahawk1986)" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/styles/readtheorg/js/readtheorg.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Ansible Playbooks f√ºr yaVDR</h1>
<div id="table-of-contents">
<h2>Inhaltsverzeichnis</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#einleitung">Einleitung</a>
<ul>
<li><a href="#lizenz">Lizenz</a></li>
<li><a href="#vorwort">Vorwort</a></li>
<li><a href="#zur-syntax">Zur Syntax</a></li>
</ul>
</li>
<li><a href="#installation">1. Installation</a>
<ul>
<li><a href="#systemvoraussetzungen">1.1. Systemvoraussetzungen</a>
<ul>
<li><a href="#org5f38df9">1.1.1. f√ºr die Nutzung als HTPC</a></li>
<li><a href="#org40ca7d7">1.1.2. Nutzung als Server</a></li>
</ul>
</li>
<li><a href="#orgbd96542">1.2. Installation des Basissystems</a>
<ul>
<li><a href="#org706c149">1.2.1. Download des Ubuntu Server ISO</a></li>
<li><a href="#org27f0964">1.2.2. <span class="todo TODO">TODO</span> Installation von Ubuntu Server</a></li>
</ul>
</li>
<li><a href="#org7d82a45">1.3. yaVDR-Installation mit Ansible</a>
<ul>
<li><a href="#org19da665">1.3.1. Herunterladen von yavdr-ansible</a></li>
<li><a href="#orgb2025bc">1.3.2. Anpassen der Vorkonfiguration</a></li>
<li><a href="#orgf9774d1">1.3.3. Ausf√ºhren der Installationsskripte</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org9151d5f">2. Grundlegendes zum System</a>
<ul>
<li><a href="#org67baa09">2.1. SSH</a></li>
<li><a href="#orgd273aee">2.2. Mit erh√∂hten Rechten Arbeiten</a></li>
<li><a href="#orge8f0480">2.3. Editoren</a></li>
<li><a href="#orge4f4d92">2.4. Paketverwaltung</a>
<ul>
<li><a href="#org00bef3e">2.4.1. Updates Einspielen</a></li>
<li><a href="#org0587814">2.4.2. Entfernen ungenutzter Pakete und alter Kernel</a></li>
</ul>
</li>
<li><a href="#orga6a3f24">2.5. Dienste</a>
<ul>
<li><a href="#org4a9d97b">2.5.1. systemctl</a></li>
<li><a href="#org5ff5a89">2.5.2. Besonderheiten f√ºr eventlircd</a></li>
</ul>
</li>
<li><a href="#orge8c70f1">2.6. Logdateien</a></li>
<li><a href="#orga7f3082">2.7. Audioausgabe</a>
<ul>
<li><a href="#org9c9ab0a">2.7.1. Pulseaudio vor√ºbergehend deaktivieren</a></li>
<li><a href="#orgd4940f6">2.7.2. Pulseaudio komplett deaktivieren</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org47d3589">3. Netzwerkdienste</a>
<ul>
<li><a href="#org1cc49c2">3.1. NFS</a>
<ul>
<li><a href="#org4678b0e">3.1.1. zus√§tzliche Freigaben</a></li>
<li><a href="#org2859d95">3.1.2. avahi-linker</a></li>
</ul>
</li>
<li><a href="#org9c70486">3.2. Samba</a></li>
</ul>
</li>
<li><a href="#orgb6adb28">4. Ausgabe mit Xorg</a>
<ul>
<li><a href="#orgab7caed">4.1. yavdr-frontend</a>
<ul>
<li><a href="#org9dae611">4.1.1. Verhalten beim Start</a></li>
</ul>
</li>
<li><a href="#org985b72a">4.2. Programme starten</a>
<ul>
<li><a href="#org240e5a8">4.2.1. desktop-Plugin</a></li>
<li><a href="#org5b744ee">4.2.2. frontend-dbus-send</a></li>
</ul>
</li>
<li><a href="#orgd86bb7b">4.3. Mehrere Bildschirme</a>
<ul>
<li><a href="#org599ed79">4.3.1. osd2web auf zweitem Monitor</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgdabbc47">5. VDR</a>
<ul>
<li><a href="#orgb4bde21">5.1. Bedienung des VDR</a></li>
<li><a href="#orgc7396b0">5.2. Unterst√ºtzte Ausgabeplugins</a>
<ul>
<li><a href="#org7ee8542">5.2.1. Bekannte Probleme bei den Ausgabeplugins:</a></li>
</ul>
</li>
<li><a href="#org3164696">5.3. Konfiguration des VDR</a>
<ul>
<li><a href="#orgfdd77ea">5.3.1. Umgebungsvariablen</a></li>
<li><a href="#org6f141f5">5.3.2. Startargumente</a></li>
<li><a href="#org6695a7f">5.3.3. Shutdown</a></li>
<li><a href="#org30e511e">5.3.4. H√§ufige Problemstellungen</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org923f033">6. KODI</a>
<ul>
<li>
<ul>
<li><a href="#org26d26eb">6.0.1. VNSI</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org7a112bd">7. vdr-epg-daemon</a>
<ul>
<li><a href="#org22191c8">7.1. H√§ufige Probleme</a>
<ul>
<li><a href="#org43c9a4d">7.1.1. epgd startet nicht</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org4dcb1d3">8. Sundtek Treiber</a>
<ul>
<li><a href="#sundtek-delay-vdr-start">8.1. Start des VDR verz√∂gern, bis alle Tuner initialisiert wurden</a></li>
<li><a href="#sundtek-dynamic-includes">8.2. Sundtek-Tuner automatisch zur Laufzeit des VDR einbinden lassen</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-orgf777d8f" class="outline-2">
<h2 id="einleitung">Einleitung</h2>
<div class="outline-text-2" id="text-einleitung">
</div>
<div id="outline-container-org2c8ac3a" class="outline-3">
<h3 id="lizenz">Lizenz</h3>
<div class="outline-text-3" id="text-lizenz">
<p>
Dieses Dokument steht unter der <a href="http://www.gnu.org/licenses/fdl-1.3.txt">GNU FDL</a>
</p>
</div>
</div>
<div id="outline-container-org84aa99a" class="outline-3">
<h3 id="vorwort">Vorwort</h3>
<div class="outline-text-3" id="text-vorwort">
<p>
yaVDR (yet another VDR) ist eine f√ºr die Nutzung des <a href="http://www.tvdr.de/">Video Disk Recorder</a> von Klaus Schmidinger angepasste Distribution auf der Basis von Ubuntu Linux, das mit Paketen aus eigenen Paketquellen erweitert wird, um die Nutzung aktueller Versionen des VDR, von KODI und anderer erforderlicher Pakete zu erm√∂glichen.
</p>

<p>
Der VDR ist daf√ºr ausgelegt, digitales Fernsehen √ºber die g√§ngigen Empfangswege (DVB-S2, DVB-T(2), DVB-C) zu empfangen, aufzuzeichnen, zu schneiden und wiederzugeben. Mit mit dem <a href="http://www.vdr-wiki.de/wiki/index.php/Pvrinput-plugin">pvrinput-Plugin</a> und einer passenden Hauppauge-TV Karte mit MPEG2-Hardware&#x00ad;encoder ist der Empfang von analog-TV m√∂glich.
Mit KODI ist au√üerdem ein m√§chtiges MediaCenter integriert, das es erm√∂glicht einen PC mit yaVDR als <a href="https://de.wikipedia.org/wiki/Home_Theater_Personal_Computer">HTPC</a> zu nutzen.
Um eine lange Versorgung mit sicherheitsrelevanten Updates zu erm√∂glichen, baut yaVDR nach M√∂glichkeit auf <a href="https://wiki.ubuntuusers.de/Long_Term_Support/">LTS Versionen von Ubuntu</a> auf.
</p>

<p>
Bei der Installation wird unterst√ºtzte Hardware automatisch erkannt und die notwendigen Pakete installiert und vorkonfiguriert, um dem Nutzer eine schnelle Inbetriebnahme des Systems zu erm√∂glichen. Da dieser Teil der Installation als Ansible-Playbook realisiert ist, kann die Vorkonfiguration bequem erweitert und angepasst werden.
</p>

<p>
Diese Dokumentation soll die Installation, Konfiguration und Bedienung eines yaVDR Systems erkl√§ren und dem Nutzer dabei helfen, sich mit den Besonderheiten vertraut zu machen, die eine yaVDR-Installation von einer normalen Ubuntu-Installation unterscheiden.
Es ist bewusst keine Einf√ºhrung in die Grundlagen der Bedienung von (Ubuntu) Linux.
Daher wird dem Neueinsteiger empfohlen sich mit Hilfe von entsprechender Literatur oder Online-Quellen wie dem sehr umfangreichen <a href="http://wiki.ubuntuusers.de">Ubuntu Users Wiki</a> einzulesen. Die <a href="https://freedesktop.org/wiki/Software/systemd/">Dokumentation f√ºr systemd</a> kann hilfreich sein, um die Funktionsweise der von yavdr-ansible eingerichteten Dienste nachvollziehen zu k√∂nnen.
Auch f√ºr den VDR und f√ºr KODI kann an dieser Stelle nicht jedes Detail erkl√§rt werden - gute Anlaufstellen f√ºr weiterf√ºhrende Informationen sind das <a href="http://vdr-wiki.de/">VDR-Wiki</a> und das <a href="http://kodi.wiki/view/Main_Page">KODI-Wiki</a>.
Wann immer die Beschreibung von Befehlen, Funktionen oder Abl√§ufen den Rahmen dieser Dokumentation sprengen w√ºrde, wird daher auf weiterf√ºhrendes Material verlinkt. Auch Doppelungen werden nach M√∂glichkeit vermieden und stattdessen auf die entsprechende Stelle in der Dokumentation verlinkt.
</p>
</div>
</div>
<div id="outline-container-org1be2be4" class="outline-3">
<h3 id="zur-syntax">Zur Syntax</h3>
<div class="outline-text-3" id="text-zur-syntax">
<p>
Befehle, die man in der Shell ausf√ºhren kann, sehen so aus:
</p>
<div class="org-src-container">
<pre class="src src-bash">$ echo <span class="org-string">"Hallo, Welt!"</span>
Hallo, Welt!
$ sudo -i  <span class="org-comment-delimiter"># </span><span class="org-comment">erlange eine root-Shell</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">whoami</span>
root
</pre>
</div>
<p>
Ein <code>$</code> ist dabei der Prompt f√ºr einen normalen Nutzer (wie er bei der Installation angelegt wurde) und ein <code>#</code> der Prompt f√ºr den Benutzer <b>root</b>. Der Prompt wird nicht mit eingegeben, um einen Befehl auszuf√ºhren. In dem Fall w√ºrde man also <code>echo "Hallo, Welt!"</code> eingeben. Die Ausgaben des Befehl erscheinen vor dem n√§chsten Prompt (in dem Fall in Zeile 2 und 5)
</p>

<p>
Code im Dokument wird nach M√∂gichkeit mit Syntax-Highlighting dargestellt, also z.B.:
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-comment-delimiter">#</span><span class="org-comment">!/usr/bin/env python3</span>
<span class="org-keyword">print</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"Hallo, Welt"</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgc13ebac" class="outline-2">
<h2 id="installation"><span class="section-number-2">1</span> Installation</h2>
<div class="outline-text-2" id="text-installation">
</div>
<div id="outline-container-org08899ea" class="outline-3">
<h3 id="systemvoraussetzungen"><span class="section-number-3">1.1</span> Systemvoraussetzungen</h3>
<div class="outline-text-3" id="text-systemvoraussetzungen">
<ul class="org-ul">
<li>Eine von Ubuntu unterst√ºtzte x86-kompatible CPU (muss aktuell mindestens i686 kompatibel sein). Falls von der CPU unterst√ºtzt, wird eine 64-Bit Installation empfohlen.  32-Bit Installationen wurden nicht getestet.</li>
<li>F√ºr die Root-Partition (<code>/</code>) werden mindestens 8 GB empfohlen, bei einer gro√üen Mediensammlung mit KODI mindestens 32 GB. Eine SSD f√ºr die Systempartition kann die Boot-Zeit sp√ºrbar verringern.</li>
<li>Eine swap-Partition wird bei mehr als 2 GB Arbeitsspeicher nicht zwingend ben√∂tigt. Sie sollte mindestens so gro√ü wie der Arbeitsspeicher sein, um den Ruhezustand nutzen zu k√∂nnen.</li>
<li>Der Mountpoint f√ºr <code>/srv</code> sollte eine eigene Partion bekommen. Da f√ºr Aufnahmen von SD-TV bis zu ca. 3 GB/s und f√ºr HD-TV bis zu 9 GB pro Stunde an Daten geschrieben werden k√∂nnen, sollte sie ausreichend dimensioniert werden. Falls Aufnahmen und andere Medien gesammelt werden, ist eine Platte mit einer Gr√∂√üe von mehr als einem Terrabyte sinnvoll.</li>
</ul>
</div>
<div id="outline-container-org5f38df9" class="outline-4">
<h4 id="org5f38df9"><span class="section-number-4">1.1.1</span> f√ºr die Nutzung als HTPC</h4>
<div class="outline-text-4" id="text-1-1-1">
<p>
yaVDR 0.7 ist f√ºr die Nutzung mit VDPAU-f√§higen NVidia-Grafikkarten und Intel IGPs ausgelegt. F√ºr eine experimentelle Unterst√ºtzung f√ºr Grafikkarten von AMD werden Tester mit geeigneter Hardware gesucht.
</p>
</div>
</div>
<div id="outline-container-org40ca7d7" class="outline-4">
<h4 id="org40ca7d7"><span class="section-number-4">1.1.2</span> Nutzung als Server</h4>
<div class="outline-text-4" id="text-1-1-2">
<p>
Ab yaVDR 0.7 besteht die M√∂glichkeit auf die Installation der GUI-Komponenten zu verzichten und es als Backend-Server zu betreiben.
In dem Fall wird keine Grafikkarte f√ºr die hardwarebeschleunigte Ausgabe ben√∂tigt. In Verbindung mit einem Sat&gt;IP Server k√∂nnte man den Server in einer Virtuellen Maschine betreiben.
</p>
</div>
</div>
</div>
<div id="outline-container-orgbd96542" class="outline-3">
<h3 id="orgbd96542"><span class="section-number-3">1.2</span> Installation des Basissystems</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Da es in der Vergangenheit immer wieder Kompatibilit√§sprobleme durch die angepassten yaVDR Installation-Images gab, gehen wir bei yaVDR 0.7 einen anderen Weg:
</p>

<p>
Zun√§chst wird eine Ubuntu Server Installation (wichtig: ISOS f√ºr den alternative Ubuntu Server Installer nutzen, damit Bootsplash, X-Server und Abh√§ngigkeiten zu bestehenden Netzwerkverbindungen korrekt funktionieren) durchgef√ºhrt, bei der der Nutzer beliebige Point-Releases (und damit neuere Kernel) w√§hlen kann. Danach besteht die M√∂glichkeit zus√§tzliche Treiber zu installieren und die Netzwerkverbindung zu konfigurieren.
</p>

<p>
Nachdem die Grundinstallation abgeschlossen wurde, wird mit Hilfe von <a href="https://docs.ansible.com/ansible/latest/index.html">Ansible</a> das System als yaVDR-Installation konfiguriert. Der interessierte Nutzer hat die M√∂glichkeit die Installationsskripte selbst anzupassen - damit wird es deutlich leichter zus√§tzliche Paketquellen einzubinden und das System reproduzierbar auf die eigenen Bed√ºrfnisse angepasst vorkonfigurieren zu lassen.
</p>
</div>

<div id="outline-container-org706c149" class="outline-4">
<h4 id="org706c149"><span class="section-number-4">1.2.1</span> Download des Ubuntu Server ISO</h4>
<div class="outline-text-4" id="text-1-2-1">
<p>
Das Installations-ISO f√ºr den Ubuntu Server 18.04 kann von der offiziellen Ubuntu-Webseite heruntergeladen werden. Dabei sollte das alternate ISO (<a href="https://www.ubuntu.com/download/alternative-downloads#alternate-ubuntu-server-installer">https://www.ubuntu.com/download/alternative-downloads#alternate-ubuntu-server-installer</a>, z.B. <a href="http://cdimage.ubuntu.com/releases/18.04.2/release/ubuntu-18.04.2-server-amd64.iso">http://cdimage.ubuntu.com/releases/18.04.2/release/ubuntu-18.04.2-server-amd64.iso</a>) gew√§hlt werden.
</p>

<p>
Es l√§sst sich auf eine DVD brennen (f√ºr normale CD-Rohlinge ist das Image zu gro√ü) oder mit einem Tool wie <a href="https://wiki.ubuntuusers.de/dd/#Live-USB-Stick-erstellen">dd</a> auf einen USB-Stick schreiben. Eine Installation mit dem <code>mini.iso</code> (<a href="https://help.ubuntu.com/community/Installation/MinimalCD">https://help.ubuntu.com/community/Installation/MinimalCD</a>) oder √ºber PXE ist ebenfalls m√∂glich (<a href="http://cdimage.ubuntu.com/netboot/bionic/">http://cdimage.ubuntu.com/netboot/bionic/</a>).
</p>
</div>
</div>

<div id="outline-container-org27f0964" class="outline-4">
<h4 id="org27f0964"><span class="section-number-4">1.2.2</span> <span class="todo TODO">TODO</span> Installation von Ubuntu Server</h4>
</div>
</div>

<div id="outline-container-org7d82a45" class="outline-3">
<h3 id="org7d82a45"><span class="section-number-3">1.3</span> yaVDR-Installation mit Ansible</h3>
<div class="outline-text-3" id="text-1-3">
</div>
<div id="outline-container-org19da665" class="outline-4">
<h4 id="org19da665"><span class="section-number-4">1.3.1</span> Herunterladen von yavdr-ansible</h4>
<div class="outline-text-4" id="text-1-3-1">
<p>
Die Ansible-Playbook-Sammlung f√ºr yaVDR kann so heruntergeladen werden:
</p>
<div class="org-src-container">
<pre class="src src-text">$ sudo apt-get install git
$ git clone https://github.com/yavdr/yavdr-ansible
$ cd yavdr-ansible
</pre>
</div>

<p>
Um sp√§ter den aktuellsten Stand aus den Repository zu holen, kann man den Befehl <code>git pull</code> nutzen.
</p>
</div>
</div>
<div id="outline-container-orgb2025bc" class="outline-4">
<h4 id="orgb2025bc"><span class="section-number-4">1.3.2</span> Anpassen der Vorkonfiguration</h4>
<div class="outline-text-4" id="text-1-3-2">
<p>
Interessierte Nutzer haben die M√∂glichkeit die von yavdr-ansible umgesetzte Systemkonfiguration auf die eigenen Vorlieben und Gegegebenheiten anzupassen.
</p>

<p>
Nicht ben√∂tigte Rollen k√∂nnen im Playbook (<code>yavdr07.yml</code> bzw. <code>yavdr07-headless.yml</code>) auskommentiert werden und Rollen, die keine automatische Hardwareerkennung nutzen (wie z.B. <code>serial-ir</code> und <code>epgd)</code> k√∂nnen bei Bedarf aktiviert werden.
</p>

<p>
Um in <code>group_vars/all</code> definierte Variablen anzupassen, sollte man eine Datei <code>host_vars/localhost</code> anlegen und darin die gew√ºnschten Anpassungen vornehmen.
</p>
</div>

<ol class="org-ol">
<li><a id="org324749e"></a>serial-ir<br />
<div class="outline-text-5" id="text-1-3-2-1">
<p>
F√ºr serielle Empf√§nger (wie z.B. beim Atric V5) sollte im Playbook die Rolle <code>serial-ir</code> einkommentiert werden. Standardm√§√üig wird die erste serielle Schnittstelle genutzt (<code>/dev/ttyS0</code> aka COM1). Ist der Empf√§nger an der zweiten seriellen Schnittstelle angeschlossen, muss in der <code>host_vars/localhost</code> die Variable <code>serial_ir_device</code> entsprechend angepasst werden:
</p>
<div class="org-src-container">
<pre class="src src-yaml"><span class="org-variable-name">serial_ir_device</span>: ttyS1
</pre>
</div>
</div>
</li>

<li><a id="org3c65ea0"></a>epgd<br />
<div class="outline-text-5" id="text-1-3-2-2">
<p>
Wird diese Rolle im Playbook einkommentiert, richtet yavdr-ansible den vdr-epgd-daemon inkl. MariaDB-Datenbank ein und installiert das <code>vdr-plugin-epg2vdr</code>.
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-orgf9774d1" class="outline-4">
<h4 id="orgf9774d1"><span class="section-number-4">1.3.3</span> Ausf√ºhren der Installationsskripte</h4>
<div class="outline-text-4" id="text-1-3-3">
<p>
Um yaVDR mit dem vorgegebenen Playbook einzurichten, ruft man danach folgenden Befehl auf:
</p>
<div class="org-src-container">
<pre class="src src-shell">$ sudo -H ./install-yavdr.sh
</pre>
</div>
<p>
Will man nur eine Server-Installation ohne GUI, ruft man dieses Skript auf:
</p>
<div class="org-src-container">
<pre class="src src-shell">$ sudo -H ./install-yavdr-headless.sh
</pre>
</div>
</div>
</div>
</div>
</div>


<div id="outline-container-org9151d5f" class="outline-2">
<h2 id="org9151d5f"><span class="section-number-2">2</span> Grundlegendes zum System</h2>
<div class="outline-text-2" id="text-2">
<p>
Dieser Abschnitt ist insbesondere f√ºr Leser gedacht, die noch nicht besonders viel Erfahrung damit haben ein Linux-System √ºber eine Shell zu administrieren.
</p>
</div>
<div id="outline-container-org67baa09" class="outline-3">
<h3 id="org67baa09"><span class="section-number-3">2.1</span> SSH</h3>
<div class="outline-text-3" id="text-2-1">
<p>
yavdr-ansible installiert einen SSH-Server vor, der es erlaubt sich von einem anderen Rechner aus auf dem System einzuloggen. Weiterf√ºhrende Informationen gibt es im <a href="https://wiki.ubuntuusers.de/SSH/">Wiki-Artikel zu SSH</a>.
</p>
</div>
</div>
<div id="outline-container-orgd273aee" class="outline-3">
<h3 id="orgd273aee"><span class="section-number-3">2.2</span> Mit erh√∂hten Rechten Arbeiten</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Bei Ubuntu ist der Login f√ºr den Benutzer <code>root</code> standardm√§√üig deaktiviert (man kann das √§ndern, indem man f√ºr <code>root</code> ein Passwort vergibt, f√ºr den Zugriff √ºber SSH als <code>root</code> muss au√üerdem die Konfiguration des SSH-Server angepasst werden). Man kann als Mitglied in der Gruppe <code>sudo</code> (der bei der Installation angelegte Nutzer ist standardm√§√üig Mitglied in dieser Gruppe) mit dem gleichnamigen Befehl erh√∂hte Rechte erlangen: <a href="https://wiki.ubuntuusers.de/sudo/">https://wiki.ubuntuusers.de/sudo/</a>
</p>
</div>
</div>
<div id="outline-container-orge8f0480" class="outline-3">
<h3 id="orge8f0480"><span class="section-number-3">2.3</span> Editoren</h3>
<div class="outline-text-3" id="text-2-3">
<p>
Um Dateien bearbeiten zu k√∂nnen, sollte man mit einem <a href="https://wiki.ubuntuusers.de/Editor/#Kommandozeile">Editor</a> umgehen k√∂nnen. F√ºr Einsteiger bietet sich das vorinstallierte <a href="https://wiki.ubuntuusers.de/Nano/">nano</a> an.
</p>
</div>
</div>
<div id="outline-container-orge4f4d92" class="outline-3">
<h3 id="orge4f4d92"><span class="section-number-3">2.4</span> Paketverwaltung</h3>
<div class="outline-text-3" id="text-2-4">
<p>
Ubuntu nutzt <code>apt</code> f√ºr die Paketverwaltung. Im Ubuntu Users Wiki findet sich alles wissenswerte <a href="https://wiki.ubuntuusers.de/Paketverwaltung/">zum Thema Paketverwaltung</a>.
</p>

<p>
Die am h√§ufigsten genutzten Befehle sind:
</p>
<div class="org-src-container">
<pre class="src src-shell"><span class="org-comment-delimiter"># </span><span class="org-comment">Paketquellen neu einlesen</span>
sudo apt update
<span class="org-comment-delimiter"># </span><span class="org-comment">alle Pakete aktualisieren</span>
sudo apt full-upgrade
<span class="org-comment-delimiter"># </span><span class="org-comment">ein einzelnes Paket installieren</span>
sudo apt install vdr-plugin-live
<span class="org-comment-delimiter"># </span><span class="org-comment">mehrere Pakete installieren</span>
sudo apt install vdr-plugin-epgsearch vdr-plugin-streamdev-server
<span class="org-comment-delimiter"># </span><span class="org-comment">Pakete entfernen</span>
sudo apt remove PAKETNAME <span class="org-rainbow-delimiters-depth-1">[</span>PAKETNAME_2 ..<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">PPA hinzuf&#252;gen</span>
sudo add-apt-repository ppa:seahawk1986-hotmail/vdr-2.4.0
</pre>
</div>
</div>
<div id="outline-container-org00bef3e" class="outline-4">
<h4 id="org00bef3e"><span class="section-number-4">2.4.1</span> Updates Einspielen</h4>
<div class="outline-text-4" id="text-2-4-1">
<p>
Neben den Sicherheitsupdates, die f√ºr Ubuntu ausgeliefert werden (z.B. f√ºr Samba, Firefox, SSH usw.), versuchen wir yaVDR st√§ndig zu verbessern und ver√∂ffentlichen daher h√§ufiger Updates f√ºr VDR- und Kodi-Pakete, Plugins, Addons, Skripte und Templates.
</p>

<p>
Gerade bevor man dar√ºber nachdenkt eine Support-Anfrage im Forum (<a href="http://www.vdr-portal.de/">http://www.vdr-portal.de/</a>) zu stellen, sollte man √ºberpr√ºfen, ob der Fehler auch nach dem Einspielen der aktuellen Updates und einem anschlie√üenden Neustart noch auftritt. Dieses Vorgehen reduziert auch den Support-Aufwand f√ºr das yaVDR-Team.
</p>

<p>
Man kann Updates entweder √ºber Ansible ansto√üen oder sie von Hand so einspielen:
</p>
<div class="org-src-container">
<pre class="src src-bash">$ sudo apt update &amp;&amp; sudo apt full-upgrade
</pre>
</div>
<p>
Alternativ kann auch apt-get genutzt werdeny:
</p>
<div class="org-src-container">
<pre class="src src-bash">$ sudo apt-get update &amp;&amp; sudo apt-get dist-upgrade
</pre>
</div>

<p>
Wenn apt nachfragt, ob Konfigurationsdateien √ºberschrieben werden sollen, empfiehlt es sich zun√§chst die Unterschiede anzeigen zu lassen und dann zu entscheiden, ob ein h√§ndisches Zusammenf√ºhren oder das Beibehalten der aktuellen Konfiguration (oder in seltenen F√§llen die √úbernahme der neuen Datei) sinnvoll ist.
</p>

<p>
Wenn die Updates √ºber Ansible erfolgen, werden die Konfigurationsdateien automatisch auf den in den Ansible-Rollen vorgesehenen Stand gebracht.
</p>
</div>
</div>
<div id="outline-container-org0587814" class="outline-4">
<h4 id="org0587814"><span class="section-number-4">2.4.2</span> Entfernen ungenutzter Pakete und alter Kernel</h4>
<div class="outline-text-4" id="text-2-4-2">
<p>
Um nicht mehr ben√∂tigte Pakete und Kernel-Versionen zu entfernen, kann dieser Befehl genutzt werden (Ubuntu beh√§lt dabei die drei aktuellsten Kernel-Pakete):
</p>
<div class="org-src-container">
<pre class="src src-shell">$ sudo apt autoremove --purge
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orga6a3f24" class="outline-3">
<h3 id="orga6a3f24"><span class="section-number-3">2.5</span> Dienste</h3>
<div class="outline-text-3" id="text-2-5">
<p>
Seit Ubuntu 16.04 setzt Ubuntu auf Systemd (<a href="https://www.freedesktop.org/wiki/Software/systemd/">https://www.freedesktop.org/wiki/Software/systemd/</a>) als Init-System, das bis Ubuntu 14.04 genutzte Upstart wurde entfernt und daf√ºr geschriebene Units m√ºssen portiert werden. Systemd bietet eine eingeschr√§nkte Abw√§rtskompatiblit√§t zu SysV-Init: <a href="https://www.freedesktop.org/wiki/Software/systemd/Incompatibilities/">https://www.freedesktop.org/wiki/Software/systemd/Incompatibilities/</a>
</p>
</div>
<div id="outline-container-org4a9d97b" class="outline-4">
<h4 id="org4a9d97b"><span class="section-number-4">2.5.1</span> systemctl</h4>
<div class="outline-text-4" id="text-2-5-1">
<p>
<a href="https://www.freedesktop.org/software/systemd/man/systemctl.html">systemctl</a> erlaubt es Systemd Units zu steuern. Die wichtigsten Befehle sind:
</p>

<div class="org-src-container">
<pre class="src src-shell"><span class="org-comment-delimiter"># </span><span class="org-comment">Status einer Unit anzeigen</span>
systemctl status vdr
<span class="org-comment-delimiter"># </span><span class="org-comment">Unit starten</span>
systemctl start vdr
<span class="org-comment-delimiter"># </span><span class="org-comment">Unit neu starten</span>
systemctl restart vdr
<span class="org-comment-delimiter"># </span><span class="org-comment">Unit stoppen</span>
systemctl stop vdr
<span class="org-comment-delimiter"># </span><span class="org-comment">Unit deaktivieren (wird nicht mehr automatisch beim Booten gestartet)</span>
systemctl disable vdr
<span class="org-comment-delimiter"># </span><span class="org-comment">Unit aktivieren (wird gem&#228;&#223; ihres Install Abschitts automatisch beim Booten gestartet</span>
systemctl enable vdr
<span class="org-comment-delimiter"># </span><span class="org-comment">Unit maskieren (kann weder automatisch noch von Hand gestartet werden)</span>
systemctl mask vdr
</pre>
</div>
</div>
</div>
<div id="outline-container-org5ff5a89" class="outline-4">
<h4 id="org5ff5a89"><span class="section-number-4">2.5.2</span> Besonderheiten f√ºr eventlircd</h4>
<div class="outline-text-4" id="text-2-5-2">
<p>
Dienste mit Socket-Activation wie eventlircd erfordern eine besondere Behandlung, wenn man sie stoppen m√∂chte - da die <code>eventlircd.socket</code> die <code>eventlircd.service</code> beim Zugriff auf den Sockel-Pfad <code>/run/lirc/lircd</code> startet, m√ºssen beide maskiert und gestoppt werden, wenn man z.B. mit <code>evtest</code> oder <code>ir-keytable</code> auf die von eventlircd exklusiv ge√∂ffneten Kernel Input Devices zugreifen m√∂chte:
</p>
<div class="org-src-container">
<pre class="src src-shell">systemctl mask --now --runtime eventlircd<span class="org-rainbow-delimiters-depth-1">{</span>.service,socket<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>
<p>
Um eventlircd wieder zu reaktiveren kann man entweder den Rechner neu starten oder die Maskierung aufheben und die Units wieder starten:
</p>
<div class="org-src-container">
<pre class="src src-shell">systemctl unmask
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orge8c70f1" class="outline-3">
<h3 id="orge8c70f1"><span class="section-number-3">2.6</span> Logdateien</h3>
<div class="outline-text-3" id="text-2-6">
<p>
Bei Ubuntu 18.04 ist sowohl rsyslog als auch journald vorinstalliert. Die von rsyslog verwalteten Logdateien liegen wie gewohnt in <code>/var/log/</code>.
Zus√§tzlich kann man journalctl nutzen, um auf das von journald verwaltete Log zuzugreifen, z.B.:
</p>
<pre class="example">
# Logausgaben der Unit vdr.service beobachten
journalctl -u vdr -fl
# Logausgaben seit dem Booten anzeigen
journalctl -b
# Logausgaben der letzten 10 Minuten anzeigen
journalctl -l --since=-10m
</pre>
</div>
</div>
<div id="outline-container-orga7f3082" class="outline-3">
<h3 id="orga7f3082"><span class="section-number-3">2.7</span> Audioausgabe</h3>
<div class="outline-text-3" id="text-2-7">
<p>
Standardm√§√üig erfolgt die Audioausgabe √ºber pulseaudio, um auch die Nutzung von Anwendungen zu erm√∂glichen, die keine Soundausgabe √ºber Alsa beherrschen. Mit Ausnahmen einiger moderner Formate wie TrueHD or DTS-MA k√∂nnen Bitstream-Formate an den Receiver durchgereicht werden (&bdquo;Passthrough&ldquo;), so dass dieser die Dekodierung √ºbernehmen kann.
</p>

<p>
In <a href="https://kodi.wiki/view/PulseAudio">https://kodi.wiki/view/PulseAudio</a> wird u.a. die Konfiguration von Pulseaudio bei Nutzung in Verbindung mit Mehrkanalreceivern beschrieben.
</p>

<p>
Bei Bedarf kann Pulseaudio vor√ºbergehend oder komplett deaktivert werden, um die Soundkarte f√ºr Programme freizugeben, die direkt mittels Alsa darauf zugreifen sollen.
</p>
</div>

<div id="outline-container-org9c9ab0a" class="outline-4">
<h4 id="org9c9ab0a"><span class="section-number-4">2.7.1</span> Pulseaudio vor√ºbergehend deaktivieren</h4>
<div class="outline-text-4" id="text-2-7-1">
<p>
Pulseaudio kann mit Hilfe von <code>pasuspender</code> vor√ºbergehend deaktiviert werden, solange das Zielprogramm l√§uft - z.B. f√ºr KODI:
</p>
<div class="org-src-container">
<pre class="src src-shell">pasuspender -- env <span class="org-variable-name">AE_SINK</span>=ALSA kodi
</pre>
</div>
<p>
Da sich der VDR mit softhddevice (oder einem der davon abgeleiteten Plugins, die keine eigenst√§ndigen Programme f√ºr die Ausgabe bereitstellen) nicht sinnvoll mit dem <code>pasuspender</code> wrappen l√§sst, wenn man zwischendurch Pulseaudio-Programme nutzen will, kann in diesem Fall auf <code>yavdr-pasuspend</code> zur√ºckgegriffen werden:
</p>
<div class="org-src-container">
<pre class="src src-shell">yavdr-pasuspend -s <span class="org-comment-delimiter"># </span><span class="org-comment">pausiere Pulseaudio</span>
yavdr-pasuspend -r <span class="org-comment-delimiter"># </span><span class="org-comment">reaktiviere Pulseaudio</span>
</pre>
</div>
<p>
Das yavdr-frontend erm√∂glicht es pulseaudio automatisch zu pausieren, wenn softhddevice (oder ein davon abgeleitetes Ausgabeplugin) aktiv ist - dazu muss in der <code>/etc/yavdr-frontend/config.yml</code> beim Eintrag f√ºr das jeweilige Frontend (vdr -&gt; frontends) die Option <code>use_pasuspend: true</code> gesetzt werden.
</p>

<p>
In dem Fall muss die Audiokonfiguration f√ºr das Ausgabeplugin f√ºr die gew√ºnschten Alsa-Ger√§te angepasst werden.
</p>

<p>
Wichtig: Beim suspend von Pulseaudio frieren Pulseaudio-Clients mit aktiver Soundausgabe ein, bis der Suspend wieder aufgehoben wird.
</p>
</div>
</div>
<div id="outline-container-orgd4940f6" class="outline-4">
<h4 id="orgd4940f6"><span class="section-number-4">2.7.2</span> Pulseaudio komplett deaktivieren</h4>
<div class="outline-text-4" id="text-2-7-2">
<p>
In der <code>/var/lib/vdr/.config/pulse/daemon.conf</code> folgenden Eintrag machen:
</p>
<div class="org-src-container">
<pre class="src src-conf"><span class="org-variable-name">autospawn</span> = no
</pre>
</div>

<p>
Nicht vergessen die Audiokonfiguration f√ºr das Ausgabeplugin auf die gew√ºnschten Alsa-Ger√§te anzupassen!
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org47d3589" class="outline-2">
<h2 id="org47d3589"><span class="section-number-2">3</span> Netzwerkdienste</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org1cc49c2" class="outline-3">
<h3 id="org1cc49c2"><span class="section-number-3">3.1</span> NFS</h3>
<div class="outline-text-3" id="text-3-1">
</div>
<div id="outline-container-org4678b0e" class="outline-4">
<h4 id="org4678b0e"><span class="section-number-4">3.1.1</span> zus√§tzliche Freigaben</h4>
</div>
<div id="outline-container-org2859d95" class="outline-4">
<h4 id="org2859d95"><span class="section-number-4">3.1.2</span> avahi-linker</h4>
</div>
</div>
<div id="outline-container-org9c70486" class="outline-3">
<h3 id="org9c70486"><span class="section-number-3">3.2</span> Samba</h3>
</div>
</div>
<div id="outline-container-orgb6adb28" class="outline-2">
<h2 id="orgb6adb28"><span class="section-number-2">4</span> Ausgabe mit Xorg</h2>
<div class="outline-text-2" id="text-4">
<p>
W√§hrend der VDR als System Dienst l√§uft, werden die vom Nutzer ben√∂tigten Dinge im Rahmen einer Systemd User Session gestartet.
</p>

<p>
Der Start der Benutzersitzung f√ºr den User vdr ist folgenderma√üen umgesetzt:
</p>
<ul class="org-ul">
<li>Der Systemdienst <code>yavdr-xorg.service</code> startet die beiden abh√§ngigen Dienste <code>x@vt7.service</code> und <code>xlogin@vdr.service</code></li>
<li><code>xlogin@vdr.service</code> startet √ºber die <code>/var/lib/vdr/.xinitrc</code> eine <code>openbox-session</code></li>
<li>Openbox ruft das Skript <code>/var/lib/vdr/.config/openbox/autostart</code> auf</li>
<li>Das Autostart Skript bereitet die Sitzung vor und ruft das Systemd-Target <code>yavdr-desktop.target</code> f√ºr die Systemd User Session auf, so dass alle davon abh√§ngigen Dienste gestartet werden</li>
</ul>
</div>
<div id="outline-container-orgab7caed" class="outline-3">
<h3 id="orgab7caed"><span class="section-number-3">4.1</span> yavdr-frontend</h3>
<div class="outline-text-3" id="text-4-1">
<p>
<code>yavdr-frontend</code> ist ein in Python3 geschriebenes Programm, das das VDR-Frontend und andere Programme steuert.
</p>
</div>

<div id="outline-container-org9dae611" class="outline-4">
<h4 id="org9dae611"><span class="section-number-4">4.1.1</span> Verhalten beim Start</h4>
<div class="outline-text-4" id="text-4-1-1">
<p>
<code>yavdr-frontend</code> kennt ein prim√§res und ein sekund√§res Frontend, standardm√§√üig ist das als VDR Ausgabe und KODI vorbelegt.
</p>

<p>
Standardm√§√üig pr√ºft <code>yavdr-frontend</code> beim Start, ob es Hinweise daf√ºr gibt, dass der VDR f√ºr einen Timer, Plugin oder einen vom vdr-addon-acpiwakup gesetzten Aufweckzeitpunkt gestartet wurde. Wenn das nicht der Fall ist, attached es das VDR-Frontend, ansonsten bleibt es detached, bis der Nutzer eine Taste auf der Fernbedienung bzw. <code>SUPER + A</code> auf der Tastatur dr√ºckt oder auf einem anderen Weg den Befehl <code>frontend-dbus-send start</code> absetzt.
</p>
</div>
</div>
</div>


<div id="outline-container-org985b72a" class="outline-3">
<h3 id="org985b72a"><span class="section-number-3">4.2</span> Programme starten</h3>
<div class="outline-text-3" id="text-4-2">
</div>
<div id="outline-container-org240e5a8" class="outline-4">
<h4 id="org240e5a8"><span class="section-number-4">4.2.1</span> desktop-Plugin</h4>
<div class="outline-text-4" id="text-4-2-1">
<p>
Das desktop-Plugin (sollte als &bdquo;Applikationen&ldquo; im menuorg-Men√º auftauchen) bildet die GNOME-Men√ºstruktur ab - wenn eine Anwendung eine <code>.desktop</code> Datei mitbringt (oder man eine <code>.desktop</code> Datei f√ºr eine Anwendung hinterlegst), kann man sie dar√ºber &bdquo;standalone&ldquo; starten (unter der Voraussetzung, dass der Prozess nicht forkt oder sich sonst der Kontrolle durch die generische Systemd-Unit entzieht). Im Hintergrund wird dann √ºber <code>/var/lib/vdr/plugins/desktop/starter</code> (was ein symbolischer Link auf <code>/usr/bin/start-desktop</code> ist) mit dem Pfad der <code>.desktop</code> Datei aufgerufen. Das yavdr-frontend sieht dann nach, ob es eine Systemd-Unit mit dem Namen gibt (abz√ºglich einer eventuell vorhandenen <code>.desktop</code> Endung - das kann man z.B. nutzen, wenn Programme mit speziellen Argumenten gestartet werden m√ºssen oder zum Beenden besondere Befehle n√∂tig sind - vgl. z.B. <code>/var/lib/vdr/.config/systemd/user/kodi.service</code>) , ansonsten f√§llt es auf <code>/usr/lib/systemd/user/app@.service</code> zur√ºck, f√ºr die dann eine Instanz mit dem Namen der Anwendung gestartet wird.
</p>

<p>
Wenn eine <code>.desktop</code> Datei (keine Systemd-Unit!) parallel zum VDR-Frontend √ºber menuorg gestartet werden soll, kann man das mit dem Programm <code>/usr/bin/run-desktop-file</code> machen, da f√ºr den VDR passende Umgebungsvariablen gesetzt sind, um auf die Session zugreifen zu k√∂nnen.
</p>
</div>
</div>
<div id="outline-container-org5b744ee" class="outline-4">
<h4 id="org5b744ee"><span class="section-number-4">4.2.2</span> frontend-dbus-send</h4>
<div class="outline-text-4" id="text-4-2-2">
<p>
yavdr-frontend bietet au√üerdem eine DBus-API an, √ºber die man den Wechsel je nach Anwendungszweck sch√∂ner steuern kann - f√ºr menuorg-Eintr√§ge bzw. die commands.conf des VDR g√§be es <code>~frontend-dbus-send start_desktop NAME_DER_DESKTOP_DATEI</code> (alternativ kann man auch frontend-dbus-send switchto NAME_DER_DESKTOP_DATEI nutzen, daf√ºr kann man auch die in der Konfigurationsdatei <code>/etc/yavdr-frontend/config.yml</code> im Abschnitt Applications definierten besonderen Namen wie &bdquo;vdr&ldquo;, &bdquo;mediacenter&ldquo;, &bdquo;browser&ldquo; usw. nutzen), wenn man mit einer Taste auf der Fernbedienung zwischen einer Anwendung und dem VDR-Frontend hin- und herschalten k√∂nnen will, w√§re z.B. frontend-dbus-send switchbetween vdr NAME_DER_DESKTOP_DATEI eine M√∂glichkeit.
</p>
</div>
</div>
</div>

<div id="outline-container-orgd86bb7b" class="outline-3">
<h3 id="orgd86bb7b"><span class="section-number-3">4.3</span> Mehrere Bildschirme</h3>
<div class="outline-text-3" id="text-4-3">
<p>
yavdr-ansible unterst√ºtzt die Ausgabe auf zwei Bildschirmen. Der prim√§re Bildschirm stellt standardm√§√üig das VDR-Frontend, KODI und andere Programme dar. Ist ein sekund√§rer Bildschirm erkannt worden, wird dieser standardm√§√üig f√ºr die Darstellung von osd2web genutzt.
</p>

<p>
Man kann die Ausgabe auf prim√§rem und sekund√§rem Monitor vertauschen, indem man das Skript <code>/var/lib/vdr/bin/switch-displays</code> innerhalb der User Session (z.B. √ºber irexec) oder als root mit korrekt gesetzter <code>DBUS_SESSION_BUS_ADDRESS=/run/user/666</code> aufruft.
</p>
</div>

<div id="outline-container-org599ed79" class="outline-4">
<h4 id="org599ed79"><span class="section-number-4">4.3.1</span> osd2web auf zweitem Monitor</h4>
<div class="outline-text-4" id="text-4-3-1">
<p>
Wenn ein <code>DISPLAY</code> mit der Addresse <code>:0.1</code> existiert (das ist vorhanden, wenn das Ansible-Playbook einen zweiten Monitor erkannt und konfiguriert hat), wird auf diesem ein Webbrowser (Voreinstellung: <code>kiosk-browser</code>) zur Darstellung der von <code>osd2web</code> bereitgestellten Webseite angezeigt.
</p>

<p>
Die daf√ºr zust√§ndige Systemd-Unit ist <code>/var/lib/vdr/.config/systemd/user/osd2web.service</code>. Die in dieser Unit genutzten Vorgabewerte f√ºr die Variablen <code>url</code> und <code>browser</code> k√∂nnen durch das Anlegen der Datei <code>/var/lib/vdr/.config/osd2web/config</code> mit den gew√ºnschten Variablenzuweisungen √ºbersteuert werden.
</p>

<p>
Um z.B. statt dem vorkonfigurierten anthraize-Theme das bluecd-Theme zu nutzen, k√∂nnte man die Variable <code>url</code> so setzen (<code>?onlyView=1</code> sorgt daf√ºr, dass die Steuerungselemente ausgeblendet werden):
</p>
<div class="org-src-container">
<pre class="src src-shell"><span class="org-variable-name">url</span>=<span class="org-string">"http://192.168.1.30:4444/skins/horchiTft/index.html?theme=bluecd?onlyView=1"</span>
</pre>
</div>

<p>
Das Plugin ist auf Port <code>4444</code> erreichbar, dort werden auch die verf√ºgbaren Themes mit den zugeh√∂rigen URLs gelistet.
</p>
</div>
</div>
</div>
</div>


<div id="outline-container-orgdabbc47" class="outline-2">
<h2 id="orgdabbc47"><span class="section-number-2">5</span> VDR</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-orgb4bde21" class="outline-3">
<h3 id="orgb4bde21"><span class="section-number-3">5.1</span> Bedienung des VDR</h3>
<div class="outline-text-3" id="text-5-1">
<p>
Um die grundlegende Bedienung und die Konfiguration des VDR √ºber das OSD werden im Benutzerhandbuch beschrieben:
</p>

<p>
<a href="http://vdr-wiki.de/wiki/index.php/Benutzerhandbuch">http://vdr-wiki.de/wiki/index.php/Benutzerhandbuch</a>
</p>

<p>
Die standardm√§√üig √ºber die <code>remote.conf</code> des VDR vorkonfigurierte Tastenbelegung f√ºr die Tastatur sieht so aus:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Tabelle 1</span> Tastenbelegung</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Taste</th>
<th scope="col" class="org-left">Funktion</th>
<th scope="col" class="org-left">Anmerkung</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Pos1/Home/Tab</td>
<td class="org-left">Men√º</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Backspace</td>
<td class="org-left">Exit</td>
<td class="org-left">Kehrt zum √úbergeordneten Men√º zur√ºck</td>
</tr>

<tr>
<td class="org-left">Enter</td>
<td class="org-left">Ok</td>
<td class="org-left">Au√üerhalb des OSD-Men√ºs: kleine Info-Anzeige</td>
</tr>

<tr>
<td class="org-left">Pfeil Auf</td>
<td class="org-left">Nach oben</td>
<td class="org-left">Au√üerhalb des OSD-Men√ºs: Kanal hoch</td>
</tr>

<tr>
<td class="org-left">Pfeil Ab</td>
<td class="org-left">Nach unten</td>
<td class="org-left">Au√üerhalb des OSD-Men√ºs: Kanal runter</td>
</tr>

<tr>
<td class="org-left">Pfeil links</td>
<td class="org-left">Nach links</td>
<td class="org-left">Au√üerhalb des OSD-Men√ºs: Wechsel der Kanalgruppe</td>
</tr>

<tr>
<td class="org-left">Pfeil rechts</td>
<td class="org-left">nach rechts</td>
<td class="org-left">Au√üerhalb des OSD-Men√ºs: Wechsel der Kanalgruppe</td>
</tr>

<tr>
<td class="org-left">Ende</td>
<td class="org-left">Info</td>
<td class="org-left">√ñffnet die Informationen zu einem Listenelement</td>
</tr>

<tr>
<td class="org-left">Pause</td>
<td class="org-left">Power</td>
<td class="org-left">VDR herunterfahren</td>
</tr>

<tr>
<td class="org-left">F1</td>
<td class="org-left">Rot</td>
<td class="org-left">Belegung wird bei aktivem OSD eingeblendet.</td>
</tr>

<tr>
<td class="org-left">F2</td>
<td class="org-left">Gr√ºn</td>
<td class="org-left">Belegung wird bei aktivem OSD eingeblendet.</td>
</tr>

<tr>
<td class="org-left">F3</td>
<td class="org-left">Gelb</td>
<td class="org-left">Belegung wird bei aktivem OSD eingeblendet.</td>
</tr>

<tr>
<td class="org-left">F4</td>
<td class="org-left">Blau</td>
<td class="org-left">Belegung wird bei aktivem OSD eingeblendet.</td>
</tr>

<tr>
<td class="org-left">F5</td>
<td class="org-left">Zur√ºckspulen</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">F6</td>
<td class="org-left">Vorspulen</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">F10</td>
<td class="org-left">Mute</td>
<td class="org-left">Schaltet den Ton aus oder ein</td>
</tr>

<tr>
<td class="org-left">F11</td>
<td class="org-left">Leiser</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">F12</td>
<td class="org-left">Lauter</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Zifferntasten</td>
<td class="org-left">Ziffern 0-9</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orgc7396b0" class="outline-3">
<h3 id="orgc7396b0"><span class="section-number-3">5.2</span> Unterst√ºtzte Ausgabeplugins</h3>
<div class="outline-text-3" id="text-5-2">
<p>
Da das originale softhddevice nicht mehr weiterentwickelt zu werden scheint, gibt es mittlerweise eine Reihe von Ablegern, die je nach Einsatzszenario mehr oder weiniger gut geeignet sind.
Aktuell sind die folgenden Pakete f√ºr Ausgabeplugins verf√ºgbar:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Paketname</th>
<th scope="col" class="org-left">VDPAU</th>
<th scope="col" class="org-left">VAAPI</th>
<th scope="col" class="org-left">HEVC</th>
<th scope="col" class="org-right">ffmpeg</th>
<th scope="col" class="org-left">Kommentar</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">vdr-plugin-softhddevice-vpp</td>
<td class="org-left">Ja</td>
<td class="org-left">Ja</td>
<td class="org-left">Ja (Software)</td>
<td class="org-right">3.4</td>
<td class="org-left">Fork von softhddevice, unterst√ºtzt Ausgabe √ºber VDPAU und VAAPI</td>
</tr>

<tr>
<td class="org-left">vdr-plugin-softhddevice-vdpau-hevc</td>
<td class="org-left">Ja</td>
<td class="org-left">Ja</td>
<td class="org-left">Ja (Hardware)</td>
<td class="org-right">3.3</td>
<td class="org-left">Wie softhddevice-vpp, aber gegen ffmpeg 3.3 gebaut</td>
</tr>

<tr>
<td class="org-left">vdr-plugin-softhddevice-openglosd</td>
<td class="org-left">Ja</td>
<td class="org-left">Nein</td>
<td class="org-left">Nein</td>
<td class="org-right">3.4</td>
<td class="org-left">Fork von softhddevice mit hardwarebeschleunigtem OSD</td>
</tr>

<tr>
<td class="org-left">vdr-plugin-softhddevice-openglosd-ffmpeg-2.8</td>
<td class="org-left">Ja</td>
<td class="org-left">Nein</td>
<td class="org-left">Nein</td>
<td class="org-right">2.8</td>
<td class="org-left">wie softhddevice-openglosd, scheint mit ffmpeg 2.8 stabiler zu laufen</td>
</tr>

<tr>
<td class="org-left">vdr-plugin-softhddevice</td>
<td class="org-left">Ja</td>
<td class="org-left">Nein</td>
<td class="org-left">Ja (Software)</td>
<td class="org-right">3.4</td>
<td class="org-left">F√ºr neuere ffmpeg-Versionen angepasste Weiterentwicklung von softhddevice-vpp</td>
</tr>

<tr>
<td class="org-left">vdr-plugin-softhddevice-ffmpeg-2.8</td>
<td class="org-left">Ja</td>
<td class="org-left">Nein</td>
<td class="org-left">Nein</td>
<td class="org-right">2.8</td>
<td class="org-left">originale Variante des softhddevice-Plugin, gegen ffmpeg 2.8 gebaut.</td>
</tr>

<tr>
<td class="org-left">vdr-plugin-vaapidevice</td>
<td class="org-left">Nein</td>
<td class="org-left">Ja</td>
<td class="org-left">Ja (Software)</td>
<td class="org-right">3.3</td>
<td class="org-left">Auf VAAPI reduzierte Variante von softhddevice-vpp</td>
</tr>

<tr>
<td class="org-left">vdr-plugin-vaapidevice-hecv</td>
<td class="org-left">Nein</td>
<td class="org-left">Ja</td>
<td class="org-left">Ja (Hardware)</td>
<td class="org-right">3.3</td>
<td class="org-left">wie vaapidevice, gegen ffmpeg-3.3 gebaut</td>
</tr>

<tr>
<td class="org-left">vdr-plugin-softhdcuvid</td>
<td class="org-left">Ja</td>
<td class="org-left">Nein</td>
<td class="org-left">Ja (CUVID)</td>
<td class="org-right">3.4</td>
<td class="org-left">F√ºr Nvidia-Karten mit CUDA/CUVID Decoder (ab GT630 Kepler und h√∂her)</td>
</tr>

<tr>
<td class="org-left">vdr-plugin-xineliboutput</td>
<td class="org-left">Ja</td>
<td class="org-left">Ja</td>
<td class="org-left">Ja (Software)</td>
<td class="org-right">3.4</td>
<td class="org-left">Unterst√ºtzt VAAPI und VDPAU, l√§uft auch ohne Hardwarebeschleunigung in VMs</td>
</tr>
</tbody>
</table>
<p>
HEVC sollte mit Nvidia-GPUs ab der GTX 950/GT 1030 aufw√§rts und mit Intel IGPs ab der Skylake-Generation (mehr als 8-Bit pro Farbkanal erst ab Kabylake) funktionieren. Die Ausgabe ist bislang auf 8-Bit pro Farbkanal beschr√§nkt.
</p>
</div>
<div id="outline-container-org7ee8542" class="outline-4">
<h4 id="org7ee8542"><span class="section-number-4">5.2.1</span> Bekannte Probleme bei den Ausgabeplugins:</h4>
<div class="outline-text-4" id="text-5-2-1">
<dl class="org-dl">
<dt>softhddevice-vpp</dt><dd>Farbfehldarstellung des OSD mit bestimmten Nvidia-Karten (z.B. GT630 mit Kepler Chipsatz)</dd>
<dt>VDPAU mit ffmpeg 3.4/3.3</dt><dd>bei SAT-Empfang in Verbindung Crashes auf bestimmten Sendern, in dem Fall eine der Varianten mit ffmpeg 2.8 verwenden.</dd>
<dt>VDPAU und VAAPI mit ffmpeg 3.4</dt><dd>keine Hardwarebeschleunigung f√ºr HEVC-Material, in dem Fall eine Variante mit ffmpeg 3.3 verwenden.</dd>
</dl>
</div>
</div>
</div>
<div id="outline-container-org3164696" class="outline-3">
<h3 id="org3164696"><span class="section-number-3">5.3</span> Konfiguration des VDR</h3>
<div class="outline-text-3" id="text-5-3">
</div>
<div id="outline-container-orgfdd77ea" class="outline-4">
<h4 id="orgfdd77ea"><span class="section-number-4">5.3.1</span> Umgebungsvariablen</h4>
<div class="outline-text-4" id="text-5-3-1">
<p>
F√ºr den VDR und die von der Systemd-Unit genutzten Hilfsskripte k√∂nnen in der Konfigurationsdatei <code>/etc/default/vdr</code> Umgebungsvariablen gesetzt werden.
</p>
</div>
</div>
<div id="outline-container-org6f141f5" class="outline-4">
<h4 id="org6f141f5"><span class="section-number-4">5.3.2</span> Startargumente</h4>
<div class="outline-text-4" id="text-5-3-2">
<p>
Wie schon bei yaVDR 0.6 wird weiterhin die ARGSDIR-Konfiguration genutzt. Wenn der VDR ohne Argumente gestartet wird, liest er beim Start alle Dateien mit der Endung <code>.conf</code> im Verzeichnis <code>/etc/vdr/conf.d/</code> ein.
</p>

<p>
Die Konfigurationsdateien nutzen eine vom <code>.ini</code>-Format gewohnte Syntax.
</p>
<ul class="org-ul">
<li>Zeilen, die mit einer Raute (<code>#</code>) beginnen, werden vom Parser ignoriert.</li>
<li>Jeder Abschnitt wird durch einen Begriff in eckigen Klammern eingeleitet, der angibt, wof√ºr die Argumente in den nachfolgenden Zeilen gelten sollen. Um Startargumente f√ºr den VDR zu definieren schreibt man also <code>[vdr]</code> und f√ºr Plugins den Pluginnamen, z.B. <code>[softhddevice]</code> f√ºr das Softhddevice-Plugin.</li>
<li>In den folgenden Zeilen k√∂nnen dann Start-Argumente f√ºr den VDR bzw. das jeweilige Plugin √ºbergeben werden.</li>
<li>Falls es mehrere Abschnitte gibt, die mit dem gleichen Begriff in eckigen Klammern eingeleitet werden, werden nur die Abschnitte f√ºr <code>[vdr]</code> zusammengefasst, bei Plugins wird die Konfiguration jeweils einzeln an den VDR √ºbergeben, wodurch Plugins mehrfach mit unterschiedlichen Startargumenten geladen werden k√∂nnen. Plugins wie z.B. xineliboutput vertragen es nicht, wenn mehrere Instanzen geladen werden.</li>
</ul>

<p>
Um ein Plugin vom VDR laden zu lassen, gen√ºgt es seinen Namen in eckigen Klammern in einer Konfigurationsdatei abzulegen. Will man den Start verhindern, muss man daf√ºr sorgen, dass der VDR den Eintrag nicht mehr einliest. Ein bequemes Werkzeug um Plugins zu (de-)aktivieren oder die Start-Argumente zu bearbeiten ist <a href="#orgc58ebd5">vdrctl</a>.
</p>

<p>
Die Datei <code>/etc/vdr/conf.d/00_vdr.conf</code> enth√§lt die vom Distributor vorgegebenen Start-Argumente f√ºr den VDR. Da alle Dateien in <code>/etc/</code>, die aus Paketen stammen, vom Paket-System als Konfigurationsdateien angesehen werden, k√∂nnen diese nach Wunsch ver√§ndert werden. Falls ein Paket beim Update eine davon abweichende Version mitbringt, erh√§lt man eine R√ºckfrage, welche Version man √ºbernehmen m√∂chte.
</p>

<p>
Die Plugin-Pakete werden mit vorgefertigten Konfigurationsdateien ausgeliefert, die nach <code>/etc/vdr/conf.avail/&lt;plugin_name&gt;.conf</code> installiert und (falls der Distributor vorgibt, dass das Plugin automatisch nach der Installation aktiviert werden soll, wie es bei yaVDR der Fall ist) nach <code>/etc/vdr/conf.d/&lt;priorit√§t&gt;-&lt;plugin_name&gt;.conf</code> verlinkt werden. Die standardm√§√üig gesetzte Priorit√§t ist 50, ein abweichender Wert kann vom Distributor vorgegeben werden.
</p>

<p>
Alle Konfigurationsdateien in <i>etc/vdr/conf.d</i> werden nach Dateinamen sortiert interpretiert und somit die Plugins in der Reihenfolge der gesetzten Priorit√§t geladen. Das Plugin mit der niedrigsten numerischen Priorit√§t wird zuerst geladen und das Plugin mit der h√∂chsten numerischen Priorit√§t als letztes.
</p>

<p>
Mit dem folgenden Befehl kann man sich die vom VDR eingelesenen Startargumente anzeigen lassen:
</p>
<div class="org-src-container">
<pre class="src src-shell">$ vdr --showargs
</pre>
</div>
</div>
<ol class="org-ol">
<li><a id="orgc58ebd5"></a>vdrctl<br />
<div class="outline-text-5" id="text-5-3-2-1">
<p>
vdrctl ist ein Hilfsprogramm, das die Verwaltung der Konfigurationsdateien f√ºr den VDR vereinfacht. Es kann die n√∂tigen Symlinks anlegen bzw. entfernen und Konfigurationsdateien mit einem Editor √∂ffnen.
</p>

<p>
Hier ein paar Beispiele zur Verwendung:
</p>
<div class="org-src-container">
<pre class="src src-shell"><span class="org-comment-delimiter"># </span><span class="org-comment">Hilfe zu vdrctl anzeigen.</span>
vdrctl -h

<span class="org-comment-delimiter"># </span><span class="org-comment">Status aller verf&#252;gbaren Plugins und statischen Konfigurationdateien</span>
$ vdrctl status

<span class="org-comment-delimiter"># </span><span class="org-comment">Aktivierung eines Plugins.</span>
$ sudo vdrctl enable streamdev-client

<span class="org-comment-delimiter"># </span><span class="org-comment">Ein Plugin unter Angabe der Priorit&#228;t aktivieren.</span>
$ sudo vdrctl enable dynamite -p 90

<span class="org-comment-delimiter"># </span><span class="org-comment">Aktivierung mehrerer Plugins.</span>
$ sudo vdrctl enable streamdev-client vnsiserver

<span class="org-comment-delimiter"># </span><span class="org-comment">Ein Plugin deaktivieren.</span>
$ sudo vdrctl disable iptv

<span class="org-comment-delimiter"># </span><span class="org-comment">Mehrerere Plugins deaktivieren.</span>
$ sudo vdrctl disable streamdev-client streamdev-server iptv

<span class="org-comment-delimiter"># </span><span class="org-comment">Bearbeiten der Konfiguration f&#252;r ein Plugin.</span>
$ sudo vdrctl edit imonlcd

<span class="org-comment-delimiter"># </span><span class="org-comment">Bearbeiten der Konfiguration mit einem Wunsch-Editor (hier vim):</span>
$ <span class="org-variable-name">EDITOR</span>=vim sudo vdrctl edit imonlcd
</pre>
</div>
</div>
</li>
</ol>
</div>

<div id="outline-container-org6695a7f" class="outline-4">
<h4 id="org6695a7f"><span class="section-number-4">5.3.3</span> Shutdown</h4>
<div class="outline-text-4" id="text-5-3-3">
</div>
<ol class="org-ol">
<li><a id="orgfa1579f"></a>Shutdown-Hooks<br />
<div class="outline-text-5" id="text-5-3-3-1">
<p>
Zus√§tzlich zu den im VDR verankerten Mechanismen um einen Shutdown zu verhindern (Benutzeraktivit√§t, anstehender Timer, Plugin verhindert Shutdown w√§hrend gewisser Operationen) gibt es die M√∂glichkeit den Shutdown-Versuch durch Hook-Skripte in <code>/etc/vdr/shutdown-hooks/</code> (bzw. von Paketen abgelegte Skripte in <code>/usr/share/vdr/shutdown-hooks/</code>) abzubrechen, die √ºber den <code>vdr-shutdown-wrapper</code> und das Skript <code>/usr/lib/vdr/vdr-shutdown</code> aufgerufen werden.
</p>
</div>
<ol class="org-ol">
<li><a id="orga6ae73c"></a>vdr-addon-acpiwakeup<br />
<div class="outline-text-6" id="text-5-3-3-1-1">
<p>
Das Addon setzt √ºber <code>/sys/class/rtc/rtc0/wakealarm</code> bzw. √ºber einen anderen √ºber die Umgebungsvariable <code>WAKEALARM</code> in <code>/etc/default/vdr</code> bzw. <code>/etc/vdr/vdr-addon-acpiwakeup.conf~</code> angegebenen RTC-kompatiblen Node die Aufweckzeit.
Einstellungen wie das regelm√§√üige Aufwecken des Rechners, wenn kein Timer definiert wurde k√∂nnen √ºber die Konfigurationsdatei <code>/etc/vdr/vdr-addon-acpiwakeup.conf</code> vorgenommen werden werden.
</p>
</div>
</li>
<li><a id="org7c50b24"></a>vdr-addon-lifeguard-ng<br />
<div class="outline-text-6" id="text-5-3-3-1-2">
<p>
Das lifeguard-ng Addon verhindert den Shutdown f√ºr konfigurierbare Shutdown-Hindernisse wie bestehene SSH-, NFS- und Samba-Verbindungen von Clients. Dar√ºber hinaus lassen im Netzwerk aktive Hosts bzw. pingbare IP-Addressen sowie angemeldete Nutzer und bestehende TC/IP-Verbindungen als Abbruchkriterien f√ºr den Shutdown konfigurieren. Die Konfiguration erfolgt √ºber die <code>/etc/lifeguard.conf</code>.
</p>
</div>
</li>
</ol>
</li>

<li><a id="orgedfef57"></a>Shutdown durch den VDR verhindern<br />
<ol class="org-ol">
<li><a id="orgf6f66bb"></a>automatischen Shutdown bei Inaktivit√§t verhindern<br />
<div class="outline-text-6" id="text-5-3-3-2-1">
<p>
Um zu verhindern, dass der VDR bei Inaktivit√§t herunterf√§hrt, kann man die Option &bdquo;VDR ausschalten bei Inaktivit√§t (min)&ldquo; auf den Wert <code>0</code> setzen. Alternativ bei gestopptem VDR in der <code>/var/lib/vdr/setup.conf</code> die Variable <code>MinUserInactivity = 0</code> setzen.
</p>
</div>
</li>
<li><a id="org7572470"></a>Shutdown-Befehl entfernen<br />
<div class="outline-text-6" id="text-5-3-3-2-2">
<p>
Will man den Shutdown durch den VDR generell unterbinden, kann man in der Datei <code>/etc/vdr/conf.d/00-vdr.conf</code> die Zeile mit dem Argument f√ºr den Shutdown-Befehl auskommentieren bzw. entfernen:
</p>
<div class="org-src-container">
<pre class="src src-conf"><span class="org-comment-delimiter">#</span><span class="org-comment">--shutdown=/usr/lib/vdr/vdr-shutdown-wrapper</span>
</pre>
</div>
</div>
</li>
</ol>
</li>
</ol>
</div>
<div id="outline-container-org30e511e" class="outline-4">
<h4 id="org30e511e"><span class="section-number-4">5.3.4</span> H√§ufige Problemstellungen</h4>
<div class="outline-text-4" id="text-5-3-4">
</div>
<ol class="org-ol">
<li><a id="org93635a3"></a>VDR startet, bevor die DVB-Karten initialisiert wurden<br />
<div class="outline-text-5" id="text-5-3-4-1">
<p>
Es gibt mehrere Ans√§tze das Problem in yaVDR anzugehen:
</p>
</div>
<ol class="org-ol">
<li><a id="org772874f"></a>Start des VDR verz√∂gern<br />
<div class="outline-text-7" id="text-5-3-4-1-0-1">
<p>
Die mitgelieferte Systemd-Unit <b>wait-for-dvb@.service</b> erlaubt es den VDR erst starten zu lassen, wenn die vorgegeben Tuner verf√ºgbar sind.
Nach einem Timeout von 90 Sekunden startet der VDR trotzdem, wenn ein Tuner dann immer noch nicht aufgetaucht ist.
</p>

<p>
Die Aktivierung der Unit muss f√ºr jeden gew√ºnschten Tuner erfolgen - um z.B. auf <code>/dev/dvb/adapter0</code> zu warten:
</p>
<div class="org-src-container">
<pre class="src src-shell">$ sudo systemctl enable wait-for-dvb@0.service
</pre>
</div>
<p>
Bei Systemen mit vielen Tunern kann man auch eine Shell-Expansion nutzen, um die Unit f√ºr mehrere Tuner auf einmal zu aktivieren (hier z.B. f√ºr 8 Tuner):
</p>
<div class="org-src-container">
<pre class="src src-shell">$ sudo systemctl enable wait-for-dvb@<span class="org-rainbow-delimiters-depth-1">{</span>0..7<span class="org-rainbow-delimiters-depth-1">}</span>.service
</pre>
</div>

<p>
Wenn Tuner ausgebaut/abgesteckt werden, sollte der dazugeh√∂rige Service wieder deaktiviert werden - hier z.B. f√ºr das Ger√§t <code>/dev/dvb/adapter7</code>:
</p>
<div class="org-src-container">
<pre class="src src-shell">$ sudo systemctl disable wait-for-dvb@7.service
</pre>
</div>
<p>
Wichtig: das funktioniert nur f√ºr Tuner, f√ºr die udev-Events ausgel√∂st werden, f√ºr Sundtek-Empf√§nger bitte das Vorgehen in <a href="#org4dcb1d3">Sundtek Treiber</a> beachten!
</p>
</div>
</li>
<li><a id="orge6a4c8d"></a>dynamite-Plugin<br />
<div class="outline-text-7" id="text-5-3-4-1-0-2">
<p>
Das dynamite-Plugin bindet DVB-Karten nachtr√§glich automatisch ein, sobald sie verf√ºgbar sind (leider gibt es Inkompatibilit√§ten mit anderen Plugins wie z.B. pvrinput)
</p>
</div>
</li>
</ol>
</li>
<li><a id="org7b027b1"></a>VDR startet nicht<br />
<div class="outline-text-5" id="text-5-3-4-2">
<p>
Zu den h√§ufigsten Problemursachen (ein Blick in die Logdateien hilft, um die Ursache zu erkennen) geh√∂ren:
</p>
<ul class="org-ul">
<li>das Aufnahmeverzeichnis existiert nicht</li>
<li>der User vdr hat keinen vollen Zugriff auf das Aufnahmeverzeichnis (Lese-, Schreib- und Ausf√ºhrungsrechte n√∂tig)</li>
<li>Es wurde ein Plugin von Hand gebaut, das nach einem Update nicht mehr zur ABI-Version des VDR passt oder dessen Symbole nicht erfolgreich gelinkt werden konnten</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org923f033" class="outline-2">
<h2 id="org923f033"><span class="section-number-2">6</span> KODI</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-org26d26eb" class="outline-4">
<h4 id="org26d26eb"><span class="section-number-4">6.0.1</span> VNSI</h4>
<div class="outline-text-4" id="text-6-0-1">
<p>
Pakete <code>vdr-plugin-vnsiserver</code> und <code>kodi-pvr-vdr-vnsi</code> installieren, dann in KODI in den Addon-Einstellungen das PVR-Addon VNSI aktivieren.
</p>
</div>
</div>
</div>

<div id="outline-container-org7a112bd" class="outline-2">
<h2 id="org7a112bd"><span class="section-number-2">7</span> vdr-epg-daemon</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-org22191c8" class="outline-3">
<h3 id="org22191c8"><span class="section-number-3">7.1</span> H√§ufige Probleme</h3>
<div class="outline-text-3" id="text-7-1">
</div>
<div id="outline-container-org43c9a4d" class="outline-4">
<h4 id="org43c9a4d"><span class="section-number-4">7.1.1</span> epgd startet nicht</h4>
<div class="outline-text-4" id="text-7-1-1">
</div>
<ol class="org-ol">
<li><a id="orgda2a8bb"></a>Fehlende Locale<br />
<div class="outline-text-5" id="text-7-1-1-1">
<p>
Die UDF <code>epglv</code> f√ºr MariaDB ben√∂tigt die Locale <code>de_DE.UTF-8</code> - wenn diese fehlt, gibt es eine Fehlermeldung wie diese im Log:
</p>
<div class="org-src-container">
<pre class="src src-text">May  2 11:19:01 hdvdr epgd: SQL-Error in 'select epglv('123', '123')' - Can't initialize function 'epglv'; EPGLV() failed to change locale (1123)
May  2 11:19:01 hdvdr epgd: SQL-Error in 'select epglvr('123', '123')' - Can't initialize function 'epglvr'; EPGLV() failed to change locale (1123)
</pre>
</div>

<p>
Abhilfe schaft es mittels <code>sudo dpkg-reconfigure locales</code> daf√ºr zu sorgen, dass die Locales f√ºr <code>de_DE.UTF-8</code> erzeugt werden.
</p>

<p>
Nach einer &bdquo;normalen&ldquo; Ubuntu Server Installation mit deutscher Sprache sehen die f√ºr debconf gesetzten Einstellungen so aus:
</p>
<div class="org-src-container">
<pre class="src src-shell">$ sudo debconf-show locales
 * locales/locales_to_be_generated: de_DE.UTF-8 UTF-8, en_US.UTF-8 UTF-8
 * locales/default_environment_locale: de_DE.UTF-8
</pre>
</div>
<p>
Nach √Ñnderungen an den Locale-Einstellungen sollte der Rechner neu gestartet werden, damit garantiert ist, dass alle Prozesse die √Ñnderungen mitbekommen.
</p>
</div>
</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org4dcb1d3" class="outline-2">
<h2 id="org4dcb1d3"><span class="section-number-2">8</span> Sundtek Treiber</h2>
<div class="outline-text-2" id="text-8">
<p>
F√ºr die Nutzung von Sundtek DVB-Tunern muss das Paket <code>dvb-driver-sundtek</code> installiert werden.
</p>

<p>
<code>LD_PRELOAD=/opt/lib/libmediaclient.so</code> muss f√ºr alle Programme als Umgebungsvariable gesetzt werden, die die Sundtek-Ger√§te nutzen sollen (wie z.B. <code>w_scan</code>).
</p>

<p>
Damit der VDR die vom Sundtek mediasrv erstellten Devices nutzen kann, muss die Unit <code>vdr.service</code> mit dem folgendem Snippet erweitert werden:
</p>
<div class="org-src-container">
<pre class="src src-systemd"><span class="org-comment-delimiter"># </span><span class="org-comment">/etc/systemd/system/vdr.service.d/sundtek.conf</span>
<span class="org-type">[Service]</span>
<span class="org-keyword">Environment</span>=LD_PRELOAD=/opt/lib/libmediaclient.so
</pre>
</div>


<p>
Prinzpiell gibt es zwei M√∂glichkeiten die Tuner mit dem VDR zu nutzen, die in den folgenden Abschnitten genauer erl√§utert werden:
</p>
<ul class="org-ul">
<li><a href="#sundtek-delay-vdr-start">Start des VDR verz√∂gern, bis alle Tuner intialisiert wurden</a></li>
<li><a href="#sundtek-dynamic-includes">Sundtek-Tuner automatisch zur Laufzeit des VDR einbinden lassen</a></li>
</ul>
</div>

<div id="outline-container-orgd126084" class="outline-3">
<h3 id="sundtek-delay-vdr-start"><span class="section-number-3">8.1</span> Start des VDR verz√∂gern, bis alle Tuner initialisiert wurden</h3>
<div class="outline-text-3" id="text-sundtek-delay-vdr-start">
<div class="org-src-container">
<pre class="src src-systemd"><span class="org-comment-delimiter"># </span><span class="org-comment">/etc/systemd/system/sundtek.service</span>
<span class="org-type">[Unit]</span>
<span class="org-keyword">Description</span>=Sundtek mediasrv
<span class="org-comment-delimiter">#</span><span class="org-comment">After=network-online.target</span>
<span class="org-keyword">Before</span>=vdr.service

<span class="org-type">[Service]</span>
<span class="org-keyword">Type</span>=<span class="org-builtin">forking</span>
<span class="org-keyword">ExecStart</span>=/opt/bin/mediasrv -d --pluginpath=/opt/bin --wait-for-devices
<span class="org-keyword">ExecStop</span>=/opt/bin/mediaclient --shutdown
<span class="org-keyword">Restart</span>=<span class="org-builtin">on-failure</span>

<span class="org-type">[Install]</span>
<span class="org-keyword">WantedBy</span>=multi-user.target
</pre>
</div>

<p>
Die Unit kann dann mit dem folgenden Befehl aktiviert werden, damit sie beim Systemstart automatisch ausgef√ºhrt wird:
</p>
<div class="org-src-container">
<pre class="src src-shell">systemctl enable sundtek.service
</pre>
</div>

<p>
Falls man Netzwerktuner √ºber die <code>/etc/sundtek.conf</code> einbinden will, muss die Zeile <code>After=network-online.service</code> einkommentiert werden und au√üerdem muss sichergestellt sein, dass der Server dauerhaft erreichbar ist.
</p>

<p>
Nachteil dieser Variante ist, dass man Sundtek-Tuner zur Laufzeit des VDR nicht hinzuf√ºgen bzw. entfernen kann, daf√ºr funktionieren Plugins, die voraussetzen, dass bestimmte Device Nodes f√ºr die DVB-Ger√§te existieren.
</p>
</div>
</div>

<div id="outline-container-org12466e4" class="outline-3">
<h3 id="sundtek-dynamic-includes"><span class="section-number-3">8.2</span> Sundtek-Tuner automatisch zur Laufzeit des VDR einbinden lassen</h3>
<div class="outline-text-3" id="text-sundtek-dynamic-includes">
<p>
Um lokal angeschlossene Tuner automatisch ein- bzw. aush√§ngen zu lassen m√ºssen die Pakete <code>vdr-plugin-dynamite</code> und <code>vdr-plugin-sundtek</code> installiert werden.
</p>

<p>
Das <code>vdr-plugin-sundtek</code> reagiert auf Meldungen des mediasrv f√ºr neu hinzugef√ºgte bzw. abgesteckte Sundtek-Tuner und bindet diese √ºber das <code>vdr-plugin-dynamite</code> ein bzw. h√§ngt sie aus.
</p>

<p>
Das automatische Einbinden von √ºber Avahi angek√ºndigten Netzwerktunern ist aktuell noch nicht m√∂glich, da der von fr√ºheren yaVDR-Versionen bekannte <code>avahi-sundtek-mounter</code> erst noch angepasst werden muss.
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Autor: Alexander Grothe (seahawk1986)</p>
<p class="date">Created: 2019-08-03 Sa 19:33</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
